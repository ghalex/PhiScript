<?xml version="1.0" encoding="utf-8"?>
<ListItemRenderer onCreationComplete="creationComplete()">

	<Import className="popups.AddNewTaskPopUp" />
	
	<HBox width="100%" 
		  height="35"
		  gap="5"
		  paddingLeft="10">
		  
		<CheckBox id="chk"
				  onMousedown="stopSelectingTask()"
				  onClick="putTaskAsDone()" />
		
		<Label id="taskTitleLb" text="{this.data.label}" width="100%" />
		
		<Image source="assets/images/create.gif"
			   onMousedown="stopSelectingTask()"
			   onClick="showAddPopUp()"
			   buttonMode="true" />
			   
		<Image source="assets/images/delete.png" 
			   onClick="deleteTask()" 
			   buttonMode="true" />
			   	   
		<Image id="optionsBtn"
			   source="assets/images/options.png"
			   onMousedown="stopSelectingTask()"
			   onClick="showOptionsMenu()"
			   buttonMode="true" />
	</HBox>
	
	<JavaScript>
		
		creationComplete: function()
		{
			
		},
			
		showAddPopUp: function()
		{
			var popUp = Phi.Mn.PopUpManager.createPopUp( AddNewTaskPopUp, {hideOnClick: false} );
			
			popUp.show( true );
			popUp.center();
		},
		
		showOptionsMenu: function()
		{
			this.optionsMenu = new Phi.UI.Menu();
			this.optionsMenu.setDataProvider( this.menuDp() );
			this.optionsMenu.snapTo( this.optionsBtn );
		},
		
		putTaskAsDone: function( event )
		{
			event.stopPropagation();
			
			this.taskTitleLb.removeClass('strike');
		
			if( this.chk.getChecked() == true )
				this.taskTitleLb.addClass('strike');
		},
		
		deleteTask: function()
		{
			this.sendMessage("deleteTask", {task: this.data});
		},
	
		stopSelectingTask: function( event )
		{
			event.stop();
		},
		
		menuDp: function()
		{
			var op = new Phi.Core.ArrayCollection();
			
			op.addItem( new Phi.Mvc.Model({label: "Move Up"}));
			op.addItem( new Phi.Mvc.Model({label: "Move Down"}));
			op.addItem( new Phi.Mvc.Model({type: "separator"}));
			op.addItem( new Phi.Mvc.Model({label: "Settings"}));
			
			return op;
		}
		
	</JavaScript>
</ListItemRenderer>